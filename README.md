# Road segmentation with ML: comparing the performances of ResNet and UNET

This project was made for the Machine Learning course at EPFL (CS-433). We will do road segmentation on a dataset provided by the teachers of the course, and comparing the performances on two nets, and three processings of the original dataset.

## Getting Started

Clone this repository to your machine to run. You will find instructions on how to use ResNet and UNET in the README of their respective folders.

The dataset can be downloaded [here](https://github.com/epfml/ML_course/tree/master/projects/project2/project_road_segmentation/Datasets). Several processing techniques are proposed and required below.

### Prerequisites

Prerequisites for [ResNet](ResNet/README.md) and [UNET](UNET/README.md) can be found in the README of their respective folders.

## Preparing the dataset

Both ResNet and UNET only take 256x256 images as input, while our dataset has 400x400 and 608x608 images. We provide cropping and uncropping functions in the file [cropping.py](cropping.py).

We trained the nets on three processings of this cropped dataset:
* Base dataset: the original cropped dataset
* Augmented dataset: the original dataset, augmented with rotations and flipping of each image of the original dataset, generated by [augmentation.py](augmentation.py)
* Segmented dataset: in order to have inputs closer to the output, we segmented the original dataset using [thresholding](https://en.wikipedia.org/wiki/Thresholding_(image_processing)). This dataset is generated by [segmentation.py](segmentation.py)

### Base dataset
[Download](https://github.com/epfml/ML_course/tree/master/projects/project2/project_road_segmentation/Datasets) the dataset, put it in the folder [dataset](dataset) and run:
```
python cropping.py
```
This will crop the dataset and put it in the corresponding the folders of each net, so that they can be run on this dataset.

### Augmented dataset
[Download](https://github.com/epfml/ML_course/tree/master/projects/project2/project_road_segmentation/Datasets) the dataset, put it in the folder [dataset](dataset) and run:
```
python augmentation.py
```
This will generate the cropped and augmented dataset and put it in the corresponding the folders of each net, so that they can be run on this dataset.

### Segmented dataset
[Download](https://github.com/epfml/ML_course/tree/master/projects/project2/project_road_segmentation/Datasets) the dataset, put it in the folder [dataset](dataset) and run:
```
python segmentation.py
```
This will generate the cropped and segmented dataset and put it in the corresponding the folders of each net, so that they can be run on this dataset.

## Running nets

Each net has a specific exectuable in their own folder:
* [ResNet/run_resnet.py](ResNet/run.py) for ResNet
* [UNET/run_unet.py](UNET/run_unet.py) for unet

The global executable [run.py](run.py) will generate the test outputs for the best results we could get through all of our tests of the two nets.

## Authors

* **RÃ©mi Clerc**  - [Minauras](https://github.com/Minauras)
* **Jonas Morin** - [Jono711](https://github.com/Jono711)
* **Jordan Metz** - [metzj](https://github.com/metzj)

Work used for UNET and ResNet specifically can be found in the readme of their respective folders.
