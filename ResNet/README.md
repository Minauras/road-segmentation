# Road segmentation using UNET

Here is the implementation of ResNet for our road segmentation project, we will compare its performances with UNET.

## Getting Started

Clone the master repository to your machine in order to use the implementation of ResNet.

### Prerequisites

* Tensorflow
* openCV 3
* Pillow
* Pytorch

### Using your dataset

This implementation of ResNet-50 runs on 256x256 images. If your training and/or testing files have larger dimensions, it is fine since the program has a cropping feature. However if your training files have smaller dimensions, you will have to provide bigger pictures. For the small testing images, the code should run just fine but errors may appear.

* Put your training images in the folder data/train/image/ as either a .png file or one include in Pillow dependency. They must be ZxZ 3-channel (RGB) images, with Z>256.
* Put your training labels in the folder data/train/label/ as either a .png file or one include in Pillow dependency. They must be ZxZ 1-channel (grayscale) images, with Z>256. The image must correspond to the provided training images (same dimensions, same place).
* Put your test images in the folder data/test/ as either a .png file or one include in Pillow dependency. They must be ZxZ 3-channel (RGB) images, with Z>256, not especially the same size as the training images.
* Leave the folder data/npydata empty. It will contain the masks after data is generated by the network.
* Leave the folder results/ empty. It will contain the output images of the test and the mask and a csv file of submission format for submission on the aicrowd challenge.

## Running the Net

Once your data is put in the correct place, open a terminal and run:

```
python unet-run.py
```
This will generate a submission to AICrowdand, save you the losses, the last and the best model of the training stage in the result folder.

You can also run:

```
python implementation.py
```
This will train your data on a certain model and save you the losses, the last and the best model in the result folder.

You can play with the numerous input both in run and implementation to obtain different model and submissions for different
results (Look at the .py files for more informations).


## Authors

* **RÃ©mi Clerc**  - [Minauras](https://github.com/Minauras)
* **Jonas Morin** - [Jono711](https://github.com/Jono711)
* **Jordan Metz** - [metzj](https://github.com/metzj)

Original work based on the [ResNet documentation page](https://pytorch.org/hub/pytorch_vision_resnet/), and on the unpublished paper of I. Utlu and Y. Kitane [Road Segmentation from Satellite Images].


## Acknowledgments

* We would like to thank I. Utlu and Y. Kitane for their work on Resnet and Pytorch for their very clear tutorial about resnet50.